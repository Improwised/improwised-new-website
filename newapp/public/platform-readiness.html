<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platform Engineering Readiness Assessment</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom styles for form elements for better appearance across browsers */
        input[type="radio"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 1.25rem;
            /* 20px */
            height: 1.25rem;
            /* 20px */
            border-radius: 9999px;
            /* Fully rounded */
            border: 2px solid #D1D5DB;
            /* gray-300 */
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: inline-block;
            vertical-align: middle;
        }

        input[type="radio"]:checked {
            border-color: #2563EB;
            /* blue-600 */
            background-color: #2563EB;
            /* blue-600 */
            position: relative;
        }

        input[type="radio"]:checked::before {
            content: '';
            display: block;
            width: 0.5rem;
            /* 8px */
            height: 0.5rem;
            /* 8px */
            background-color: white;
            border-radius: 9999px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        input[type="radio"]:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
            /* focus-ring-blue-500 */
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col items-center p-4 sm:p-8">

    <div id="app-container" class="max-w-4xl w-full bg-white rounded-3xl shadow-xl p-6 sm:p-10 border border-gray-200">
        <!-- Content will be rendered here by JavaScript -->
    </div>

    <script>
        // Data Definitions
        const twelveFactorQuestions = [
            {
                id: 'codebase',
                question: 'Do you use a single codebase tracked in revision control for each application, deploying many deploys from it?',
                options: [
                    { text: 'Yes, always a single codebase with multiple deploys.', score: 5 },
                    { text: 'Mostly, some exceptions exist.', score: 3 },
                    { text: 'Rarely, often multiple codebases for one app.', score: 1 },
                    { text: 'No, practices vary significantly.', score: 0 },
                ],
            },
            {
                id: 'dependencies',
                question: 'Are all dependencies explicitly declared and isolated?',
                options: [
                    { text: 'Yes, via dependency declaration files (e.g., package.json, pom.xml).', score: 5 },
                    { text: 'Mostly, some implicit dependencies or global installations.', score: 3 },
                    { text: 'Rarely, dependencies often managed manually or inconsistently.', score: 1 },
                    { text: 'No, dependencies are not explicitly managed.', score: 0 },
                ],
            },
            {
                id: 'config',
                question: 'Is configuration stored in the environment (e.g., environment variables, config service)?',
                options: [
                    { text: 'Yes, all configuration is externalized to the environment.', score: 5 },
                    { text: 'Mostly, some configuration is still hardcoded or in files.', score: 3 },
                    { text: 'Rarely, configuration often bundled with code or in version control.', score: 1 },
                    { text: 'No, configuration is typically hardcoded.', score: 0 },
                ],
            },
            {
                id: 'backingServices',
                question: 'Are backing services (databases, message queues) treated as attached resources?',
                options: [
                    { text: 'Yes, attached via configuration and interchangeable.', score: 5 },
                    { text: 'Mostly, some services are tightly coupled.', score: 3 },
                    { text: 'Rarely, services are often tightly coupled and not easily swappable.', score: 1 },
                    { text: 'No, services are integrated directly into the codebase.', score: 0 },
                ],
            },
            {
                id: 'buildReleaseRun',
                question: 'Do you strictly separate build, release, and run stages?',
                options: [
                    { text: 'Yes, distinct and automated stages.', score: 5 },
                    { text: 'Mostly, some overlap or manual steps.', score: 3 },
                    { text: 'Rarely, stages are often combined or not clearly defined.', score: 1 },
                    { text: 'No, a clear separation is not present.', score: 0 },
                ],
            },
            {
                id: 'processes',
                question: 'Are applications executed as one or more stateless processes?',
                options: [
                    { text: 'Yes, all processes are stateless and share-nothing.', score: 5 },
                    { text: 'Mostly, some processes maintain internal state but handle scaling.', score: 3 },
                    { text: 'Rarely, processes often store state locally, hindering scalability.', score: 1 },
                    { text: 'No, processes are typically stateful.', score: 0 },
                ],
            },
            {
                id: 'portBinding',
                question: 'Are services exposed via port binding?',
                options: [
                    { text: 'Yes, services are self-contained and export services via port binding.', score: 5 },
                    { text: 'Mostly, some services use internal communication or fixed ports.', score: 3 },
                    { text: 'Rarely, services rely on specific network configurations.', score: 1 },
                    { text: 'No, services are not exposed via port binding.', score: 0 },
                ],
            },
            {
                id: 'concurrency',
                question: 'Is concurrency scaled out via the process model?',
                options: [
                    { text: 'Yes, by adding more processes (e.g., horizontally scaling containers).', score: 5 },
                    { text: 'Mostly, some components scale vertically or use threads.', score: 3 },
                    { text: 'Rarely, scaling is often manual or not well-defined.', score: 1 },
                    { text: 'No, scaling is not a primary concern or not well-understood.', score: 0 },
                ],
            },
            {
                id: 'disposability',
                question: 'Are processes designed for fast startup and graceful shutdown?',
                options: [
                    { text: 'Yes, processes are highly disposable for rapid elastic scaling.', score: 5 },
                    { text: 'Mostly, some processes have slow startup/shutdown times.', score: 3 },
                    { text: 'Rarely, processes are not designed for quick disposal.', score: 1 },
                    { text: 'No, processes are long-lived and difficult to manage.', score: 0 },
                ],
            },
            {
                id: 'devProdParity',
                question: 'Is there strong dev/prod parity across development, staging, and production environments?',
                options: [
                    { text: 'Yes, environments are as identical as possible.', score: 5 },
                    { text: 'Mostly, minor differences exist but are managed.', score: 3 },
                    { text: 'Rarely, significant divergences between environments.', score: 1 },
                    { text: 'No, environments are very different.', score: 0 },
                ],
            },
            {
                id: 'logs',
                question: 'Are logs treated as event streams?',
                options: [
                    { text: 'Yes, logs are aggregated centrally for analysis.', score: 5 },
                    { text: 'Mostly, logs are collected but analysis is limited.', score: 3 },
                    { text: 'Rarely, logs are stored locally on servers.', score: 1 },
                    { text: 'No, logs are not centrally managed.', score: 0 },
                ],
            },
            {
                id: 'adminProcesses',
                question: 'Are admin/management tasks run as one-off processes?',
                options: [
                    { text: 'Yes, through automated scripts or platform tooling.', score: 5 },
                    { text: 'Mostly, some manual admin tasks.', score: 3 },
                    { text: 'Rarely, admin tasks are often manual or integrated into app code.', score: 1 },
                    { text: 'No, admin tasks are not treated as separate processes.', score: 0 },
                ],
            },
        ];

        const doraQuestions = [
            {
                id: 'deploymentFrequency',
                question: 'How frequently does your organization successfully deploy changes to production?',
                options: [
                    { text: 'Multiple deploys per day (Elite)', score: 5 },
                    { text: 'Between once per week and once per month (High)', score: 4 },
                    { text: 'Between once per month and once every six months (Medium)', score: 2 },
                    { text: 'Less than once every six months (Low)', score: 0 },
                ],
            },
            {
                id: 'leadTimeForChanges',
                question: 'What is your lead time for changes (time from code commit to code running in production)?',
                options: [
                    { text: 'Less than one hour (Elite)', score: 5 },
                    { text: 'Between one day and one week (High)', score: 4 },
                    { text: 'Between one month and six months (Medium)', score: 2 },
                    { text: 'More than six months (Low)', score: 0 },
                ],
            },
            {
                id: 'meanTimeToRestore',
                question: 'What is your mean time to restore service (MTTR) when a disruption occurs?',
                options: [
                    { text: 'Less than one hour (Elite)', score: 5 },
                    { text: 'Less than one day (High)', score: 4 },
                    { text: 'Less than one week (Medium)', score: 2 },
                    { text: 'More than one week (Low)', score: 0 },
                ],
            },
            {
                id: 'changeFailureRate',
                question: 'What percentage of changes result in a degraded service or require remediation (e.g., rollback, hotfix)?',
                options: [
                    { text: '0-15% (Elite)', score: 5 },
                    { text: '16-30% (High)', score: 4 },
                    { text: '31-45% (Medium)', score: 2 },
                    { text: '46-60%+ (Low)', score: 0 },
                ],
            },
        ];

        const cncfMaturityStages = [
            {
                name: 'Initial',
                description: 'Manual processes, inconsistent practices, ad-hoc tooling. Little to no dedicated platform team. Development teams manage most infrastructure concerns.',
                characteristics: [
                    'Manual provisioning and deployment.',
                    'Inconsistent environments across teams.',
                    'Lack of standardized tools or practices.',
                    'High operational burden on developers.',
                ],
            },
            {
                name: 'Basic',
                description: 'Some automation efforts, shared tools, emergent best practices. Early stages of a platform team or dedicated individuals supporting core infrastructure.',
                characteristics: [
                    'Basic CI/CD pipelines established.',
                    'Centralized logging/monitoring tools introduced.',
                    'Limited self-service capabilities.',
                    'Focus on foundational infrastructure (compute, network, storage).',
                ],
            },
            {
                name: 'Advanced',
                description: 'Standardized self-service, robust automation, comprehensive observability. A dedicated platform team providing internal products and services.',
                characteristics: [
                    'Automated infrastructure provisioning (IaC).',
                    'Standardized application deployment pipelines.',
                    'Comprehensive observability stack (metrics, logs, traces).',
                    'Developer self-service portals and APIs for common tasks.',
                    'Focus on developer experience and productivity.',
                ],
            },
            {
                name: 'Optimized',
                description: 'Highly autonomous teams, platform as a product, continuous improvement, innovation focus. Platform team acts as enablers and innovators.',
                characteristics: [
                    'Full self-service with guardrails.',
                    'Advanced automation and intelligent operations.',
                    'Proactive incident response and chaos engineering.',
                    'Data-driven platform development and continuous feedback loops.',
                    'Focus on business outcomes and innovation through platform capabilities.',
                ],
            },
        ];

        // Global State Variables
        let currentStep = 0;
        let answers = {};
        let readinessScore = null;
        let doraScore = null;
        let twelveFactorScore = null;
        let cncfMaturityLevel = null;

        const totalSteps = 6; // Welcome, Blocks, 12-Factor, DORA, CNCF, Results

        // Helper function to create SVG icons
        const createIcon = (name, className) => {
            const icons = {
                'Rocket': `<path d="M4.5 16.5c-1.5 1.5-1.5 3.333 0 4.5s3 1.5 4.5 0 1.5-3.333 0-4.5-3-1.5-4.5 0z"/><path d="M9 12l-6 6"/><path d="M15 12l6 6"/><path d="M12 9l6-6"/><path d="M12 15l-6 6"/><path d="M17.5 17.5l-3-3"/><path d="M19.5 5.5l-3-3"/>`,
                'Target': `<circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>`,
                'CheckCircle': `<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/>`,
                'Book': `<path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>`,
                'Gauge': `<path d="m12 14v4"/><path d="M3.34 19.16a10 10 0 1 1 17.32 0"/><path d="m9.5 9.5 4-4"/><path d="m14.5 14.5-4 4"/>`,
                'FlaskConical': `<path d="M10 2C7.8 2 6.1 3.9 6.1 6.1c0 2.3 1.8 4.2 4 4.2"/><path d="M14 2C16.2 2 17.9 3.9 17.9 6.1c0 2.3-1.8 4.2-4 4.2"/><path d="M12 10.3c-.6 0-1.2-.5-1.2-1.2v-7c0-.6.5-1.2 1.2-1.2s1.2.5 1.2 1.2v7c0 .6-.5 1.2-1.2 1.2z"/><path d="M20 16a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2v-4h-2z"/><path d="M4 16a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2H2v-4h2z"/>`,
                'Award': `<circle cx="12" cy="8" r="7"/><path d="M12 15v9"/><path d="M8.29 18.29l-3 3"/><path d="M15.71 18.29l3 3"/>`,
                'RefreshCw': `<path d="M21 12a9 9 0 0 0-9-9c-2.4 0-4.6 1.4-5.6 3.6"/><path d="M3 12a9 9 0 0 1 9 9c2.4 0 4.6-1.4 5.6-3.6"/><path d="M17 17l4 4-4 4"/><path d="M7 7l-4-4 4-4"/>`,
                'Laptop': `<path d="M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2"/>`,
                'Grid': `<rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>`,
                'Scale': `<path d="M16 16v3a1 1 0 0 0 2 0v-3"/><path d="M8 16v3a1 1 0 0 1-2 0v-3"/><path d="M3 16h18"/><path d="M12 3v13"/><path d="m19 12-7-9-7 9h14z"/>`,
                'TrendingUp': `<polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/>`,
                'Hourglass': `<path d="M5 22h14"/><path d="M5 2h14"/><path d="M17 22V7L7 2v15z"/><path d="M17 7L7 22"/>`,
                'ShieldCheck': `<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/>`,
            };
            const svgContent = icons[name] || '';
            return `<svg class="${className}" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${svgContent}</svg>`;
        };

        // UI Components as functions returning HTML strings
        const ProgressIndicator = () => `
            <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                <div
                    class="bg-blue-600 h-2.5 rounded-full"
                    style="width: ${(currentStep / (totalSteps - 1)) * 100}%"
                ></div>
            </div>
        `;

        const SectionTitle = (iconName, title) => `
            <h2 class="text-3xl font-extrabold text-gray-900 mb-6 flex items-center justify-center">
                ${createIcon(iconName, "h-9 w-9 mr-3 text-blue-600")}
                ${title}
            </h2>
        `;

        const CTAButton = (onClickHandler, children, icon, primary = true) => `
            <button
                onclick="${onClickHandler}"
                class="flex items-center justify-center px-6 py-3 rounded-full text-lg font-semibold transition-all duration-300 ease-in-out shadow-lg hover:shadow-xl
                    ${primary ? 'bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-200 text-gray-800 hover:bg-gray-300'}"
            >
                ${icon ? createIcon(icon, "h-5 w-5 mr-2") : ''}
                ${children}
            </button>
        `;

        const Card = (title, description, iconName) => `
            <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-200 flex flex-col items-center text-center">
                <div class="p-4 bg-blue-100 rounded-full mb-4">
                    ${createIcon(iconName, "h-8 w-8 text-blue-600")}
                </div>
                <h3 class="text-xl font-semibold mb-2 text-gray-800">${title}</h3>
                <p class="text-gray-600">${description}</p>
            </div>
        `;

        // State Management & Logic
        const handleAnswerChange = (section, questionId, score) => {
            if (!answers[section]) {
                answers[section] = {};
            }
            answers[section][questionId] = score;
            // Re-render the current step to reflect selection (optional for radio, but good for consistency)
            // Or just ensure the radio state is managed by the browser as it is with checked attribute
        };

        const calculateScores = () => {
            let total12FactorScore = 0;
            let max12FactorScore = twelveFactorQuestions.length * 5;
            Object.values(answers.twelveFactor || {}).forEach(score => {
                total12FactorScore += score;
            });
            twelveFactorScore = (total12FactorScore / max12FactorScore) * 100;

            let totalDoraScore = 0;
            let maxDoraScore = doraQuestions.length * 5;
            Object.values(answers.dora || {}).forEach(score => {
                totalDoraScore += score;
            });
            doraScore = (totalDoraScore / maxDoraScore) * 100;

            // Simple combined readiness score
            readinessScore = (total12FactorScore + totalDoraScore) / (max12FactorScore + maxDoraScore) * 100;

            // Determine CNCF Maturity Level based on combined score
            let determinedLevel = cncfMaturityStages[0]; // Default to Initial
            if (readinessScore >= 80) {
                determinedLevel = cncfMaturityStages[3]; // Optimized
            } else if (readinessScore >= 60) {
                determinedLevel = cncfMaturityStages[2]; // Advanced
            } else if (readinessScore >= 30) {
                determinedLevel = cncfMaturityStages[1]; // Basic
            }
            cncfMaturityLevel = determinedLevel;
        };

        const nextStep = () => {
            if (currentStep === totalSteps - 2) { // Before showing results, calculate scores
                calculateScores();
            }
            currentStep = Math.min(currentStep + 1, totalSteps - 1);
            renderStep(currentStep);
        };

        const prevStep = () => {
            currentStep = Math.max(currentStep - 1, 0);
            renderStep(currentStep);
        };

        const resetAssessment = () => {
            currentStep = 0;
            answers = {};
            readinessScore = null;
            doraScore = null;
            twelveFactorScore = null;
            cncfMaturityLevel = null;
            renderStep(currentStep);
        };

        // Main Render Function
        const renderStep = (step) => {
            const appContainer = document.getElementById('app-container');
            appContainer.innerHTML = ''; // Clear previous content

            let contentHTML = ProgressIndicator();

            if (step === 0) {
                contentHTML += `
                    <div class="text-center py-10">
                        ${SectionTitle("Laptop", "Platform Engineering Readiness Assessment")}
                        <p class="text-lg text-gray-700 mb-8 max-w-2xl mx-auto">
                            Welcome to the Platform Engineering Readiness Assessment! This tool will help you evaluate your organization's current state and readiness for adopting or maturing platform engineering practices, incorporating the 12-Factor App methodology, DORA metrics, and the CNCF Platform Engineering Maturity Model.
                        </p>
                        <div class="flex justify-center mt-8">
                            ${CTAButton("nextStep()", "Start Assessment", "Rocket")}
                        </div>
                    </div>
                `;
            } else if (step === 1) {
                contentHTML += `
                    <div class="text-center py-10">
                        ${SectionTitle("Grid", "Understanding Platform Engineering Blocks")}
                        <p class="text-lg text-gray-700 mb-10 max-w-2xl mx-auto">
                            Platform engineering focuses on building and maintaining internal developer platforms (IDPs) that provide a curated and opinionated paved road for software delivery. Here are some common "blocks" or components:
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
                            ${Card("CI/CD Pipelines", "Automating the software delivery process from code commit to deployment.", "FlaskConical")}
                            ${Card("Observability", "Centralized logging, metrics, and tracing for monitoring application health and performance.", "Gauge")}
                            ${Card("Infrastructure as Code (IaC)", "Managing and provisioning infrastructure through code instead of manual processes.", "Book")}
                            ${Card("Security & Compliance", "Integrating security best practices and compliance checks throughout the development lifecycle.", "ShieldCheck")}
                            ${Card("Self-Service Portal", "Empowering developers to provision resources and deploy applications independently.", "Target")}
                            ${Card("Service Mesh / API Gateway", "Managing inter-service communication, traffic routing, and security in microservice architectures.", "Scale")}
                        </div>
                        <div class="flex justify-between mt-8">
                            ${CTAButton("prevStep()", "Back", null, false)}
                            ${CTAButton("nextStep()", "Next")}
                        </div>
                    </div>
                `;
            } else if (step === 2) {
                contentHTML += `
                    <div class="py-10">
                        ${SectionTitle("CheckCircle", "12-Factor App Readiness")}
                        <p class="text-lg text-gray-700 mb-8 max-w-2xl mx-auto text-center">
                            The Twelve-Factor App is a methodology for building software-as-a-service applications that are robust, scalable, and maintainable. Rate your adherence to each factor:
                        </p>
                        ${twelveFactorQuestions.map((q, qIndex) => `
                            <div class="mb-8 p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100">
                                <h3 class="text-xl font-semibold mb-4 text-gray-800">${qIndex + 1}. ${q.question}</h3>
                                <div class="space-y-3">
                                    ${q.options.map(option => `
                                        <label class="flex items-center cursor-pointer p-3 rounded-md hover:bg-blue-50 transition-colors">
                                            <input
                                                type="radio"
                                                name="12factor-${q.id}"
                                                value="${option.score}"
                                                onchange="handleAnswerChange('twelveFactor', '${q.id}', ${option.score})"
                                                ${(answers.twelveFactor && answers.twelveFactor[q.id] === option.score) ? 'checked' : ''}
                                                class="form-radio h-5 w-5 text-blue-600 border-gray-300 focus:ring-blue-500"
                                            />
                                            <span class="ml-3 text-base text-gray-700">${option.text}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                        <div class="flex justify-between mt-8">
                            ${CTAButton("prevStep()", "Back", null, false)}
                            ${CTAButton("nextStep()", "Next")}
                        </div>
                    </div>
                `;
            } else if (step === 3) {
                contentHTML += `
                    <div class="py-10">
                        ${SectionTitle("TrendingUp", "DORA Metrics Assessment")}
                        <p class="text-lg text-gray-700 mb-8 max-w-2xl mx-auto text-center">
                            The four DORA (DevOps Research and Assessment) metrics are key indicators of software delivery performance. Evaluate your organization on these metrics:
                        </p>
                        ${doraQuestions.map((q, qIndex) => `
                            <div class="mb-8 p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-100">
                                <h3 class="text-xl font-semibold mb-4 text-gray-800">${qIndex + 1}. ${q.question}</h3>
                                <div class="space-y-3">
                                    ${q.options.map(option => `
                                        <label class="flex items-center cursor-pointer p-3 rounded-md hover:bg-blue-50 transition-colors">
                                            <input
                                                type="radio"
                                                name="dora-${q.id}"
                                                value="${option.score}"
                                                onchange="handleAnswerChange('dora', '${q.id}', ${option.score})"
                                                ${(answers.dora && answers.dora[q.id] === option.score) ? 'checked' : ''}
                                                class="form-radio h-5 w-5 text-blue-600 border-gray-300 focus:ring-blue-500"
                                            />
                                            <span class="ml-3 text-base text-gray-700">${option.text}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                        <div class="flex justify-between mt-8">
                            ${CTAButton("prevStep()", "Back", null, false)}
                            ${CTAButton("nextStep()", "Next")}
                        </div>
                    </div>
                `;
            } else if (step === 4) {
                contentHTML += `
                    <div class="py-10">
                        ${SectionTitle("Award", "CNCF Platform Engineering Maturity Model")}
                        <p class="text-lg text-gray-700 mb-8 max-w-2xl mx-auto text-center">
                            The CNCF Platform Engineering Maturity Model provides a framework to understand the evolution of platform capabilities. Your previous answers will help map your organization to one of these stages:
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 mb-10">
                            ${cncfMaturityStages.map(stage => `
                                <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-200">
                                    <h3 class="text-2xl font-bold text-gray-900 mb-3">${stage.name}</h3>
                                    <p class="text-gray-700 mb-4">${stage.description}</p>
                                    <h4 class="font-semibold text-gray-800 mb-2">Key Characteristics:</h4>
                                    <ul class="list-disc pl-5 text-gray-600 space-y-1">
                                        ${stage.characteristics.map(char => `<li>${char}</li>`).join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                        <div class="flex justify-between mt-8">
                            ${CTAButton("prevStep()", "Back", null, false)}
                            ${CTAButton("nextStep()", "View Results")}
                        </div>
                    </div>
                `;
            } else if (step === 5) {
                const recommendationsHTML = `
                    <div class="bg-white p-8 rounded-xl shadow-md border border-gray-200 mb-10 text-left">
                        <h3 class="text-2xl font-bold text-gray-900 mb-4">Recommendations:</h3>
                        ${readinessScore < 30 ? `
                            <p class="text-red-700">
                                Your organization appears to be in the <span class="font-bold">Initial stage</span>.
                                Focus on foundational improvements: establish basic CI/CD, centralize logging, and begin standardizing development environments.
                                Consider starting with a small, dedicated team to explore platform concepts.
                            </p>
                        ` : ''}
                        ${readinessScore >= 30 && readinessScore < 60 ? `
                            <p class="text-yellow-700">
                                Your organization appears to be in the <span class="font-bold">Basic stage</span>.
                                Focus on expanding automation efforts. Implement Infrastructure as Code (IaC) for key components, establish more robust CI/CD, and begin exploring self-service capabilities for developers.
                            </p>
                        ` : ''}
                        ${readinessScore >= 60 && readinessScore < 80 ? `
                            <p class="text-orange-700">
                                Your organization appears to be in the <span class="font-bold">Advanced stage</span>.
                                You have a solid foundation. Focus on optimizing developer experience by building comprehensive self-service portals, enhancing observability, and continually improving your automated pipelines.
                                Explore advanced topics like chaos engineering and FinOps.
                            </p>
                        ` : ''}
                        ${readinessScore >= 80 ? `
                            <p class="text-green-700">
                                Your organization appears to be in the <span class="font-bold">Optimized stage</span>.
                                You are a leader in platform engineering. Focus on innovation, refining your internal products, and enabling highly autonomous teams.
                                Share your expertise internally and externally.
                            </p>
                        ` : ''}
                    </div>
                `;

                contentHTML += `
                    <div class="text-center py-10">
                        ${SectionTitle("Rocket", "Platform Engineering Readiness Results")}
                        ${readinessScore !== null ? `
                            <p class="text-lg text-gray-700 mb-6 max-w-2xl mx-auto">
                                Based on your responses, here's an overview of your organization's readiness for platform engineering:
                            </p>

                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                <div class="bg-blue-50 p-6 rounded-xl shadow-inner border border-blue-200">
                                    <h3 class="text-xl font-semibold text-blue-800 mb-2">Overall Readiness</h3>
                                    <p class="text-4xl font-bold text-blue-600">${readinessScore.toFixed(1)}%</p>
                                    <p class="text-blue-700 mt-2">Combined 12-Factor & DORA Score</p>
                                </div>
                                <div class="bg-green-50 p-6 rounded-xl shadow-inner border border-green-200">
                                    <h3 class="text-xl font-semibold text-green-800 mb-2">12-Factor Alignment</h3>
                                    <p class="text-4xl font-bold text-green-600">${twelveFactorScore.toFixed(1)}%</p>
                                    <p class="text-green-700 mt-2">How well your apps follow 12-Factor principles</p>
                                </div>
                                <div class="bg-purple-50 p-6 rounded-xl shadow-inner border border-purple-200">
                                    <h3 class="text-xl font-semibold text-purple-800 mb-2">DORA Performance</h3>
                                    <p class="text-4xl font-bold text-purple-600">${doraScore.toFixed(1)}%</p>
                                    <p class="text-purple-700 mt-2">Your software delivery performance</p>
                                </div>
                            </div>

                            <div class="bg-gradient-to-r from-blue-100 to-indigo-100 p-8 rounded-xl shadow-lg border border-blue-300 mb-10">
                                <h3 class="text-2xl font-bold text-gray-900 mb-4 flex items-center justify-center">
                                    ${createIcon("Award", "h-7 w-7 mr-2 text-blue-700")}
                                    Your CNCF Maturity Level: <span class="ml-2 text-blue-700">${cncfMaturityLevel?.name}</span>
                                </h3>
                                <p class="text-gray-700 leading-relaxed mb-4">${cncfMaturityLevel?.description}</p>
                                <h4 class="font-semibold text-gray-800 mb-2">Key Characteristics for this stage:</h4>
                                <ul class="list-disc pl-5 text-gray-600 text-left mx-auto max-w-xl">
                                    ${cncfMaturityLevel?.characteristics.map(char => `<li>${char}</li>`).join('')}
                                </ul>
                            </div>

                            ${recommendationsHTML}

                            ${CTAButton("resetAssessment()", "Start New Assessment", "RefreshCw")}
                        ` : `
                            <p class="text-lg text-gray-700">Please complete the assessment to view your results.</p>
                        `}
                        <div class="flex justify-center mt-8">
                            ${CTAButton("prevStep()", "Back to CNCF Model", null, false)}
                        </div>
                    </div>
                `;
            }

            appContainer.innerHTML = contentHTML;
        };

        // Initial render on page load
        document.addEventListener('DOMContentLoaded', () => {
            renderStep(currentStep);
        });
    </script>
    <script>
        // function sendSize() {
        //     const height = document.documentElement.scrollHeight;
        //     const width = document.documentElement.scrollWidth;

        //     window.parent.postMessage(
        //         { frameHeight: height, frameWidth: width },
        //         "*"
        //     );
        // }

        function sendSize() {
            const el = document.getElementById("app-container");
            if (!el) return;

            const rect = el.getBoundingClientRect();

            // Height and width based on app-container
            const height = rect.height;
            const width = rect.width;

            window.parent.postMessage(
                { frameHeight: height, frameWidth: width },
                "*"
            );
        }

        // Send size on load
        window.addEventListener("load", sendSize);

        // Detect content expansion + shrink
        new ResizeObserver(sendSize).observe(document.documentElement);

        // If DOM updates trigger layout change
        new MutationObserver(sendSize).observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            characterData: true
        });
    </script>
</body>

</html>